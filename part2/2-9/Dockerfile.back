
FROM golang:1.16

WORKDIR /usr/src/app

COPY . .

ARG PORT
ARG REDIS_HOST
ARG REQUEST_ORIGIN

ARG POSTGRES_PASSWORD
ARG POSTGRES_HOST

RUN go build

ENV PORT=${PORT}
ENV REDIS_HOST=${REDIS_HOST}
ENV REQUEST_ORIGIN=${REQUEST_ORIGIN}

ENV POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
ENV POSTGRES_HOST=${POSTGRES_HOST}

EXPOSE ${PORT}

CMD ./server 